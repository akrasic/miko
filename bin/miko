#!/usr/bin/env ruby
# miko 
# Version 0.1.1
#--------------------------------

$LOAD_PATH << File.join(File.dirname(__FILE__), '../lib')
require 'find'
require 'fileutils'
require 'miko/traveler'
require 'optparse'

options = {}
optparse  = OptionParser.new do |opts|
  opts.banner = "Usage: miko [options]"

  opts.on( "-u user", "--user USER", "Username - translates into /home/USER/") do |user|
    options[:user]  = user
  end

  opts.on( "-d dir", "--directory DIRECTORY", "Specify directory instead username") do |dir|
    options[:directory] = dir
  end

  opts.on("-v", "--verbose", "Be verbose and display errors" ) do |ver|
    options[:verbose] = ver
  end

  opts.on( "-h", "--help", "Display Help") do
    puts opts
    exit
  end
end


begin
  optparse.parse!
  if options[:user].nil? and  options[:directory].nil?
    puts optparse
    exit
  end

  c = Miko::Traveler.new( options )

  begin
    c.run
    if c.found.empty?
      puts "No scripts detected"
    else
      puts "Scrips detected"
      c.found.sort.each{ | script| puts script }
    end
  rescue Exception => e
    puts e
  end
rescue OptionParser::InvalidOption, OptionParser::MissingArgument
  puts $!.to_s
  puts optparse
  exit
end

